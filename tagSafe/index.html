<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TagSafe — Ad Tag Validator</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-shell">
    <!-- Top header -->
    <header class="ts-header">
      <img
        class="tagsafe-logo"
        src="/images/logos/tagsafe-logo.PNG"
        alt="TagSafe"
      />
      <p class="ts-tagline">Fast, opinionated QA for 3rd-party ad tags.</p>
      <div class="ts-header-meta">
        <span class="badge badge-soft">internal tool</span>
        <span class="badge badge-accent">beta</span>
      </div>
    </header>    

    <main class="ts-main">
      <!-- Single tag card -->
      <section class="card card-input">
        <div class="card-header">
          <h2>Single tag sandbox</h2>
          <p>Paste a single tag to quickly preview and validate it.</p>
        </div>
        <div class="card-body">
          <label for="tagInput" class="field-label">Tag HTML / JS</label>
          <textarea
            id="tagInput"
            placeholder="Paste single tag here…"
          ></textarea>

          <div class="button-row">
            <button class="btn btn-primary" onclick="analyzeSingleTag()">
              Analyze tag
            </button>
            <button class="btn btn-ghost" onclick="clearTagInput()">
              Clear
            </button>
          </div>
        </div>
      </section>

      <!-- Bulk upload card -->
      <section class="card card-upload">
        <div class="card-header">
          <h2>Bulk tagsheet upload</h2>
          <p>
            Drag in a tagsheet to auto-detect creatives, tags, and run validation across all rows.
          </p>
        </div>
        <div class="card-body">
          <div id="uploadArea" class="dropzone">
            <p class="dropzone-title">
              Drag &amp; drop a tagsheet (<strong>.xlsx / .xls / .csv</strong>) here, or
            </p>
            <label class="file-input-label">
              <input
                id="fileInput"
                type="file"
                accept=".xlsx,.xls,.csv"
              />
              <span>Choose file</span>
            </label>
          </div>
          <div class="validation-status">
            <span id="globalValidationStatus"></span>
            <div class="validation-progress">
              <div id="validationProgressBar"></div>
            </div>
          </div>          
        </div>
      </section>

      <!-- Results card -->
      <section class="card card-results">
        <div class="card-header card-header-with-meta">
          <div>
            <h2>Creatives &amp; validation</h2>
            <p>
              Preview each creative, inspect the raw tag, and review technical checks
              (load, weight, landing page, console errors, more).
            </p>
          </div>
          <button
            type="button"
            class="rules-badge"
            title="Current rules:\n• Load time ≤ 1.5 s\n• Total weight ≤ 1500 KB\n• Max total requests ≤ 50\n• No failed network requests\n• Landing page responds with 2xx/3xx\n\nThese are tuned for WaPo display inventory."
          >
            View rules
          </button>
        </div>
        <div class="card-body card-body-results">
          <div id="creativeTableShell" class="creative-table-shell">
            <div id="creativeTable"></div>
          </div>
        </div>
      </section>      
    </main>
    <div id="validationProgressFooter" class="validation-status-footer"></div>
    <footer id="footer">
      <p>&copy;2025 Colin Bingham — TagSafe. Built on GitHub Pages.</p>
    </footer>
  </div>

  <!-- SheetJS (xlsx) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
